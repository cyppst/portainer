version: '2'
services:
  portainer:
    image: portainer/portainer
    command: --no-auth
    volumes:
    - ./portainer_data:/data
    - /var/run/docker.sock:/var/run/docker.sock
    ports:
    - 9000:9000
    networks:
    - webgateway
    labels:
    - traefik.backend=portainer
    - traefik.frontend.rule=Host:portainer.chaiyapoj.site
    - traefik.port=9000
    restart: unless-stopped
  traefik:
    image: traefik:1.5
    command: -c /dev/null --web --docker --logLevel=DEBUG --defaultEntryPoints='http','https' --entryPoints="Name:https Address::443
      TLS:/certs/traefik.cert,/certs/traefik.key" --entryPoints="Name:http Address::80"
    volumes:
    - ./certs:/certs
    - /var/run/docker.sock:/var/run/docker.sock
    ports:
    - 443:443
    - 8080:8080
    - 80:80
    networks:
    - webgateway
    restart: always
    labels:
    - traefik.frontend.rule=Host:traefik.chaiyapoj.site
networks:
  webgateway:
    external: true
